include ../../Makefile.common

%.o: %.S
	$(CC) -c $(<) -o $(@) $(INCLUDES) $(CFLAGS)

%.o: %.c
	$(CC) -c $(<) -o $(@) $(INCLUDES) $(CFLAGS) 

all: compile stage
	
compile:
	$(ARMAS) -mthumb -o payload.o steaks4uce.S
	$(OBJCOPY) -O binary payload.o payload.bin
	
stage:
	$(BIN2C) payload.bin payload.h steaks4uce
	$(CC) -o steaks4uce.o -c steaks4uce.c $(INCLUDE) $(CFLAGS)
		
clean:
	rm -rf *.o *.bin
